# -*- Makefile -*-
POFILES = po/fr.po
GMOFILES=$(POFILES:.po=.gmo)

dist_noinst_DATA += $(POFILES) \
	po/bongo.pot \
	po/POTFILES.in

po/all: update-gmo

po/clean: clean
	rm -f po/*.gmo

po/install: po/all
	for file in $(GMOFILES); do \
		lang=`echo $$file | sed 's/\.gmo//'`; \
		install -d $(prefix)/share/locale/$$lang/LC_MESSAGES/; \
		install -m 0644 $$file $(prefix)/share/locale/$$lang/LC_MESSAGES/bongo.gmo; \
	done

bongo.pot:
	xgettext --directory=${srcdir} \
	--add-comments=translators \
	--keyword=_ --keyword=N_ --keyword=M_ \
	--files-from=$(srcdir)/po/POTFILES.in \
	--msgid-bugs-address="bongo-devel@gna.org" \
	-o po/bongo.pot

update-gmo: ${GMOFILES}

update-po: ${POFILES}-update update-gmo

%.gmo:
	msgfmt -o $@ $*.po

%.po-update: bongo.pot
	msgmerge $*.po po/bongo.pot -o $*.po;
	@msgfmt --statistics $*.po
